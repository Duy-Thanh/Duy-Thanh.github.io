function getPostId(){var t=window.location.search,e={};"?"===t.charAt(0)&&(t=t.substring(1));for(var o=t.split("&"),n=0;n<o.length;n++){var r=o[n].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return e.id}function loadPost(){var t=getPostId();if(t){var e=new XMLHttpRequest;e.open("GET",root_url+"/api/posts/"+t,!0),e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status)try{displayPost(JSON.parse(e.responseText))}catch(t){displayError("Error parsing post data")}else displayError("Error loading post: "+e.statusText)},e.onerror=function(){displayError("Network error occurred")},e.send()}else window.location.href="/blog.html"}function displayPost(t){if(t&&t.title&&t.content){if(document.title=t.title+" - Blog Post",document.getElementById("postTitle").textContent=t.title,document.getElementById("postContent").innerHTML=t.content,"undefined"!=typeof Prism)document.querySelectorAll("pre code").forEach((function(t){Prism.highlightElement(t)}));document.getElementById("postMeta").innerHTML="Posted: "+formatDateTime(t.created)+(t.modified&&t.modified!==t.created?"<br>Last Modified: "+formatDateTime(t.modified):"");var e=new XMLHttpRequest;e.open("GET",root_url+"/api/check-auth",!0),e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(JSON.parse(e.responseText).isAuthenticated&&(document.getElementById("postControls").style.display="flex"))},e.send()}else displayError("Invalid post data")}function checkAuthStatus(){var t=new XMLHttpRequest;t.open("GET",root_url+"/api/check-auth",!0),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var e=JSON.parse(t.responseText),o=document.getElementById("postControls");!0===e.isAuthenticated&&o&&(o.style.display="flex")}},t.send()}function formatDateTime(t){var e=new Date(t);return e.toLocaleDateString()+" "+e.toLocaleTimeString()}function editPost(){var t=getPostId();window.location.href="/blog.html?action=edit&id="+t}function deletePost(){var t=getPostId();if(confirm("Are you sure you want to delete this post?")){var e=new XMLHttpRequest;e.open("DELETE",root_url+"/api/posts/"+t,!0),e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(window.location.href="/blog.html")},e.send()}}function displayError(t){document.title="Error - Blog Post",document.getElementById("postTitle").textContent="Error",document.getElementById("postContent").textContent=t,document.getElementById("postMeta").textContent="";var e=document.getElementById("postControls");e&&(e.style.display="none")}window.onload=function(){checkAuthStatus(),loadPost()};
